(defvar *data*)

(defun track (x y)
  (case (char (aref *data* y) x)
    (#\space nil)
    ((#\- #\> #\<) 'horizontal)
    ((#\| #\^ #\v) 'vertical)
    (#\/ 'positive-turn)
    (#\\ 'negative-turn)
    (#\+ 'junction)))

(defun find-carts ()
  (let ((result '()))
    (dotimes (x 150)
      (dotimes (y 150)
        (case (char (aref *data* y) x)
          (#\> (push (list x y 'right 'left) result))
          (#\< (push (list x y 'left 'left) result))
          (#\^ (push (list x y 'up 'left) result))
          (#\v (push (list x y 'down 'left) result)))))
    result))

(defun sort-carts (carts)
  (sort carts
        (lambda (c1 c2)
          (or (< (second c1) (second c2))
              (and (= (second c1) (second c2))
                   (< (first c1) (first c2)))))))

(defun turn (rule d)
  (let ((dirs '(up right down left))
        (rules '((right . (right down left up))
                 (left . (left up right down))
                 (positive . (right up left down))
                 (negative . (left down right up)))))
    (elt (cdr (assoc rule rules))
         (position d dirs))))

(defun next-pos (x y d)
  (case d
    (up (list x (1- y)))
    (right (list (1+ x) y))
    (down (list x (1+ y)))
    (left (list (1- x) y))))

(defun next-junction-turn (d)
  (case d
    (left 'straight)
    (straight 'right)
    (right 'left)))

(defun move-cart (cart)
  (destructuring-bind (x y d j)
      cart
    (let ((p (next-pos x y d)))
      (list (first p) (second p)
            (ecase (track (first p) (second p))
              (positive-turn (turn 'positive d))
              (negative-turn (turn 'negative d))
              (junction (case j
                          (straight d)
                          (left (turn 'left d))
                          (right (turn 'right d))))
              ((horizontal vertical) d))
            (if (eq (track (first p) (second p)) 'junction)
                (next-junction-turn j)
                j)))))

(defun collision (c1 c2)
  (and (= (first c1) (first c2))
       (= (second c1) (second c2))))

(defun move-carts (carts)
  (loop for rest on (sort-carts carts)
        for next = (move-cart (car rest))
        do (when (or (member next rest :test #'collision)
                     (member next new-carts :test #'collision))
             (return-from move-carts (list 'crash (first next) (second next))))
        collect next into new-carts
        finally (return new-carts)))

(defun adv13 ()
  (loop for carts = (find-carts) then (move-carts carts)
        until (eq (car carts) 'crash)
        ;; do (display carts)
        finally (return (cdr carts))))

(defun move-and-eliminate-carts (carts)
  (let ((new-carts '()))
    (do ((carts (sort-carts carts) (rest carts)))
        ((null carts) new-carts)
      (let ((next (move-cart (car carts))))
        (cond ((member next carts :test #'collision)
               (setf carts (delete next carts :test #'collision)))
              ((member next new-carts :test #'collision)
               (setf new-carts (delete next new-carts :test #'collision)))
              (t (push next new-carts)))))
    new-carts))

(defun adv13b ()
  (loop for carts = (find-carts) then (move-and-eliminate-carts carts)
        while (> (length carts) 1)
        finally (return (car carts))))

;;; Display for debugging

;;; Emacs key settings:
;; (fset 'cart-forward (kmacro-lambda-form [?± ?µ ?² ?\C-n ?\C-l ?\C-l] 0 "%d"))
;; (fset 'cart-back (kmacro-lambda-form [?± ?µ ?² ?\C-p ?\C-l ?\C-l] 0 "%d"))
;; (local-set-key (kbd "C-x [") 'cart-back)
;; (local-set-key (kbd "C-x ]") 'cart-forward)
(defun display (carts)
  (dotimes (y 150)
    (dotimes (x 150)
      (let ((cart (member (list x y) carts :test #'collision)))
        (princ (case (third (car cart))
                 (up #\^)
                 (right #\>)
                 (down #\v)
                 (left #\<)
                 (t (case (track x y)
                      (horizontal #\-)
                      (vertical #\|)
                      (positive-turn #\/)
                      (negative-turn #\\)
                      (junction #\+)
                      (t #\space)))))))
    (terpri))
  (format t "~%~%"))

;;; Data

(defparameter *data*
  #("              /----------------------\\                                                                              /--------------------------\\      "
    "              |                     /+------------------------------------------------------------------------------+-------------\\            |      "
    "              |                  /--++--------------------------------------------------------\\                     |             |            |      "
    "              |                  | /++--------------------------------------------------------+---------------------+-------\\     |            |      "
    "              | /----------------+-+++--------\\ /---------------------------------------------+---------------------+\\      |     |            |      "
    "              | |                | |||        | |                                            /+---------------------++------+-----+-----------\\|      "
    "         /----+-+-\\              | |||        | |               /----------------------------++---------------------++---\\  |     |           ||      "
    "         |    | | |/-------------+-+++--------+-+---------------+--->------------------------++--\\     /------------++---+--+-----+---------\\ ||      "
    "         |    | | ||     /-------+-+++--------+-+---------------+----------------------------++--+-----+-----\\      ||   |  |     |         | ||      "
    "        /+----+-+-++-----+-------+-+++--------+-+---------------+----------------------------++--+--\\  |     |      ||   |  |     |         | ||      "
    "        ||    |/+-++-----+-------+-+++--------+-+---------------+----------------------------++--+--+--+-----+-\\    ||   |  |     |         | ||      "
    "  /-----++----+++\\||     |       | |||        | |               |                            ||  |  |  |     | |    ||   |  |  /--+---------+-++----\\ "
    "  |     ||    ||||||     |       | |||        | |            /--+----------------------------++--+--+--+-----+-+----++---+--+--+--+------\\  | ||    | "
    "  |     ||    ||||||     |       | |||        | |   /--------+\\ |      /---------------------++--+--+--+-----+-+----++---+--+--+--+------+--+-++---\\| "
    "  |     ||    ||||||/----+-------+-+++--------+-+---+--------++-+------+---------------------++--+--+--+-----+-+----++---+\\ |  |  |      |  | ||   || "
    "  |     ||    |||||||/---+-------+-+++--------+-+---+--------++-+------+----------------\\    ||  |  |  |     | |    ||   || |  |  |      |  | ||   || "
    "  |     ||    ||||||||   |       | |||        | |   |        || |      |                |    ||  |  |  |     | |  /-++---++-+--+--+------+--+-++-\\ || "
    "  |  /--++----++++++++---+-------+-+++--\\   /-+-+---+--------++-+------+----------------+----++--+--+\\ |     | |  | ||   || |  |  |      |  | || | || "
    " /+--+--++----++++++++---+-------+-+++--+---+-+-+---+--------++-+------+----------------+-\\  ||  |  || |     | |  | ||   || |  |  |      |  | || | || "
    " ||  |  ||    ||||||||   |       | |||  |   | | |   |        || |      |                | |  ||/-+--++-+-----+-+--+-++\\  || |  |  |      |  | || | || "
    " ||  |  ||    ||||||||   |       | |||  |   | | |   |        || |      |       /--------+-+--+++-+--++\\|     | |  | |||  || |  |  |      |  | || | || "
    " ||  |  ||    ||||||||   |       | |||  |   | | |   |        || |      |       |        | |  ||| |  ||||     | |  | |||  || |  |  |      |  | || | || "
    " ||  |  ||    |||||^||   \\-------+-+++--+---+-+-+---+--------++-+------+-------+--------+-+--+++-+--++++-----/ |  | |||  || |  |  |      |  | || | || "
    " ||  |  \\+-<--++++++++-----------+-+++--+---+-+-+---+--------++-+------+-------+--------+-+--+++-+--/|||       |  | |||  || |  |  |      |  | || | || "
    " ||  |   |    ||||||||      /----+-+++--+---+-+-+---+--------++-+----\\ |       |        | |  ||| |   |||/------+--+-+++--++-+--+--+------+--+\\|| | || "
    " ||  |   |    ||||||||      |    | |||/-+---+-+-+---+--------++-+----+-+-------+--------+-+--+++-+---++++------+--+-+++--++-+--+--+------+-\\|||| | || "
    " ||  |   |    ||||||||      |    | |||| |  /+-+-+---+--------++-+----+-+-------+--------+-+--+++-+---++++------+--+-+++--++-+--+--+--\\   | ||||| | || "
    " ||  |   |    ||||||||      |    | \\+++-+--++-+-+---+--------++-+----+-+-------+--------+-+--+++-+---++++------+--+-+++--++-/  |  |  |   | ||||| | || "
    " ||  |   |    ||||||||      |    |  ||| |/-++-+-+---+--------++-+----+\\|       |        | |  ||| |   ||||      |  | |||  ||    |  |  |   | ||||| | || "
    " ||  |/--+----++++++++---->-+----+--+++-++-++-+-+---+--------++-+---\\|||       |        | |  ||| |   ||||      |/-+-+++--++----+--+\\ |   | ||||| | || "
    " ||  ||  |    ||||||||     /+----+--+++-++-++-+-+---+--------++-+---++++-------+--------+-+--+++-+---++++------++-+-+++--++---\\|  || |   | ||||| | || "
    " ||  ||  |    ||||||||     ||    | /+++-++-++\\| |   |        || ^   ||||       |        | |  ||| |   ||||/-----++-+-+++--++---++--++-+---+\\||||| | || "
    " ||  ||  |/---++++++++-----++----+-++++-++-++++-+---+--------++-+---++++-------+--------+-+--+++-+\\/-+++++-----++-+-+++--++---++\\ || |   ||||||| | || "
    " ||  ||  ||   ||||||||     ||    | |||| || |||| |   |        || |   ||||       |        | |  ||| ||| |||||     || | |||  ||   ||| || |   ||||||| | || "
    " ||  ||  ||   ||||||||     ||    | |||| || ||||/+---+--------++-+---++++-------+--------+-+\\ ||| ||| |||||     || | |||  ||   ||| || |   ||||||| | || "
    " ||  || /++---++++++++-----++----+-++++-++-++++++---+--------++-+---++++-------+--------+-++-+++-+++-+++++\\    || | |||  ||   ||| || |   ||||||| | || "
    " ||  || |||   ||||||||     ||    |/++++-++-++++++---+--------++\\|   ||||       |        |/++-+++-+++-++++++--\\ || | |||  ||   ||| || |   ||||||| | || "
    " ||  || |||   ||||||||     ||    |||||| || ||||||   |        ||||   ||||       \\--------++++-+++-+++-+/||||  | || | |||  ||   ||| || |   ||||||| | || "
    " |\\--++-+++---+++/||||     ||    |||||| || ||||||   |        ||||   |||| /--------------++++-+++-+++-+-++++--+-++-+-+++--++---+++-++-+\\  ||||||| | || "
    " |   \\+-+++---+++-++++-----++----++++++-/| ||||||   |        ||||   |||| |              |||| ||| ||| | ||||  | || | |||  ||   ||| || ||  ||||||| | || "
    " |    | |||   ||| ||||     ||    |||||| /+-++++++---+--------++++---++++-+--------------++++-+++-+++-+-++++--+\\|| | |||  ||   ||| || ||  ||||||| | || "
    " |    | |||   |\\+-++++-----++----++++++-++-++++++---+--------++++---++++-+--------------++++-+++-+++-+-++++--++/| | |||  ||   ||| || ||  ||||||| | || "
    " |    | |||   | | ||||     ||/---++++++-++-++++++---+--------++++---++++-+------------\\ |||| ||| ||| | ||\\+--++-+-+-+++--++---+++-++-++--+/||||| | || "
    " |    | |||   | | ||||     |||   |||||| || ||||||   | /------++++---++++-+------------+-++++-+++-+++-+-++-+--++-+-+-+++--++--\\||| || ||  | ||||| | || "
    "/+----+-+++---+\\| ||||     |||   |||||| || ||||||   | |      ||||   |||| |            | |||| ||| ||| | |\\-+--++-+-+-+++--++--++++-++-++--+-++/|| | || "
    "||    | |||   ||| ||||     |||   |||||| || ||||||   \\-+------+/|\\---++++-+------------+-++++-+++-+++-+-+--+--++-+-+-+++--/|  |||| || ||  | || || | || "
    "||  /-+-+++---+++-++++-\\   |||   |||||| |\\-++++++-----+------+-+----++/| |       /----+-++++-+++-+++-+-+--+--++-+-+\\|||   |  |||| || ||  | || || | || "
    "||  | | |||   ||| |||| |   |||   |||||| |  ||||\\+-----+------+-+----++-+-+-------+----+-+++/ ||| ||| | |/-+--++-+-+++++--\\|  |||| || ||  | || || | || "
    "||  | | |||   ||| |||| |   |||   |||||| |  |||| |     |      | |    || | |       |    | |||  ||| ||| | || |  || | |||||  ||  |||| || ||  | || || | || "
    "||  |/+-+++---+++-++++-+---+++---++++++-+--++++-+-----+------+-+----++-+-+-------+---\\| |||  ||\\-+++-+-++-+--++-+-++++/  ||  |||| || ||  | || || | || "
    "||  ||| ||\\---+++-++++-+---+++---++++++-+--++++-+-----+------+-+----++-+-+-------+---++-+++--++--+/| | \\+-+--++-+-++++---++--++++-++-++--+-+/ || | || "
    "||  ||| ||/---+++-++++-+---+++---++++++-+--++++-+-----+------+-+----++-+-+-----<-+---++-+++--++-\\| | |  | |  || | ||\\+---++--++++-++-++--+-+--+/ | || "
    "||  ||| |||   ||| |||| |   |||   |||||| |  |||| |     |      | |    || | |       |   || |||  ||/++-+-+--+-+--++-+-++-+---++\\ |||| || ||  | |  |  | || "
    "||  ||| |||   \\++-++++-+---+++---++++/| |  ||||/+-<---+------+-+----++-+-+-------+---++-+++--+++++-+\\|  | |  || | || |   ||| |||| || ||  | |  |  | || "
    "||  ||| |||    || |||| |   |||   |||| | |  ||||||     |      | |  /-++-+-+-------+---++-+++--+++++-+++--+-+-\\|| | || |   ||| |||| || ||  | |  |  | || "
    "||  ||| |||    || |||| |   |||   |||| | |  ||||||     |      | |  | || | |       |   || |\\+--+++++-+++--+-+-+/|/+-++-+---+++-++++-++-++--+-+\\ |  | || "
    "||  ||| |||    || |||| |   |||   |||| | |  ||||||     |      | |  | || | |       ^   || | |  ||||| |||  | | | ||| || |   ||| |||| || ||  | || |  | || "
    "||  ||| |||    || |||| |   |||   |||| | |  ||||||  /--+------+-+--+-++-+-+-------+---++-+-+--+++++-+++--+-+-+-+++-++-+---+++-++++-++-++\\ | || |  | || "
    "||  ||| |||    || |||| |   |||   |||| | |  ||||||  |  |      | |  | || | |       \\---++-+-+--+++++-+++--+-+-+-+++-+/ |   ||| |||| || ||| | || |  | || "
    "|\\--+++-+++----++-++++-+---+++---++++-+-+--++++++--+--+------+-+--+-++-+-+-----------++-+-/  ||||| |||  | | | ||| |  |   ||| |||| || ||| | || |  | || "
    "|   ||| |||    || |||| |   |||   |||| | |  ||||||  | /+------+\\|  | || | |           || |    ||||| |||  | | | ||| |  |   ||| |||| || ||| | || |  | || "
    "|   ||| |||    || |||| |   |||   |||| | |  ||||||  | ||      |||  | || | |/----------++-+----+++++-+++--+-+-+-+++-+--+---+++-++++-++\\||| | || |  | || "
    "|   ||\\-+++----++-++++-+---+++---++++-+-+--++++++--+-++------+++--+-/| | ||          || |    ||||| |||  | | | |||/+--+---+++-++++-++++++-+-++-+--+\\|| "
    "|/--++--+++----++-++++-+\\  |||   |||| | |/-++++++--+-++------+++--+--+-+-++----------++-+----+++++-+++--+-+-+-+++++--+---+++-++++<++++++-+-++-+\\ |||| "
    "||  ||  |||  /-++-++++-++--+++---++++-+-++-++++++--+-++------+++--+--+-+-++----------++-+----+++++-+++--+-+-+-+++++--+\\  ||| |||| |||||| | || || |||| "
    "||  ||  |||  | || ||||/++--+++---++++-+-++-++++++--+-++------+++--+--+-+-++----------++-+----+++++-+++--+-+-+\\|||||  ||  ||| |||| |||||| | || || |||| "
    "||/-++--+++--+-++-+++++++--+++---++++-+\\|| |||||\\--+-++------+++--+--+-+-++----------++-+----+++++-+++--+-+-+++++++--/|  ||| |||| |||||| | || || |||| "
    "||| ||  |||  | || |||||||  |||   |||| |||| ||||| /-+-++------+++--+--+-+-++--------\\ || |    ||||| |||  | | |||||||  /+--+++-++++-++++++-+-++-++\\|||| "
    "||| ||  |||  | || |||||||  |||   |||| |||| ||||| | | ||      |||  |  | | ||        | || |    ||||| |||  | | |||||||  ||  ||| |||| |||||| | || ||||||| "
    "||| ||  |||  | || |||||||  |\\+---++++-++++-+++++-+-+-++------+++--+--/ | ||    /---+-++-+----+++++-+++--+-+-+++++++--++--+++-++++\\|||||| | || ||||||| "
    "||| ||  |||  | || ||\\++++--+-+---++++-++++-+++++-+-+-++------+++--+----+-++----+---+-++-+----+++++-+++--+-+-+++++++--++--+/| ||||||||||| | || ||||||| "
    "||| ||  |||  | || || ||||  | |   |||| |||| \\++++-+-+-++------+++--+----+-++----+---+-++-+----+++++-+++--+-+-+++++++--++--+-+-++++++++/|| | || ||||||| "
    "||| ||  |||  | || || |v||  | |  /++++-++++--++++-+-+-++------+++--+----+-++-\\  |   | || |    ||||| |||  | | |||||||  ||  | | |||||||| || | || ||||||| "
    "||v || /+++--+-++-++-++++--+-+--+++++-++++--++++-+-+-++------+++--+----+-++-+--+---+-++-+----+++++-+++--+-+\\|||||||  ||  | | |||||||| || | || ||||||| "
    "||| || ||||  | || || ||||  | |  ||||| ||||  |||| | | ||      |||  |/---+-++-+-\\|   | || |    ||||| |||  | |||||||||  ||  | | |||||||| || | || ||||||| "
    "||| || ||||  | || || ||||  | |  ||||| ||||  |||| | | ||      |||  ||   | || | ||/--+-++-+----+++++-+++--+-+++++++++\\ ||  | | |||||||| || | || ||||||| "
    "||| || ||||  | || || ||||  | |  |||\\+-++++--+/|| | | ||      |||  ||   \\-++-+-+++--+-++-+----+++++-+++--+-++++++++++-++--+-+-++++++++-++-+-++-+++++/| "
    "||| || ||||  | || || ||||  | |  ||| | ||||  | || | | ||      |||  ||     || | |||  | || |    ||||| |||  | |||||||||| \\+--+-+-++++++++-++-+-++-++/|| | "
    "||| || ||||  \\-++-++-++++--+-+--+++-+-++++--+-++-+-+-++------+++--++-----++-+-+++--+-++-+----+++++-+++--+-++++++++++--/  | | ||\\+++++-++-+-++-++-++-/ "
    "||| || ||||    || || ||||  | |  ||| | \\+++--+-++-+-+-++------+++--++-----++-+-+++--+-++-+----+++++-+++--+-++++++++++-----+-+-++-+++++-++-+-/| || ||   "
    "||| || ||||    ||/++-++++--+-+--+++-+--+++--+-++-+-+-++------+++--++-----++-+-+++--+-++-+----+++++-+++--+-++++++++++-----+-+\\|| ||||| || |  | || ||   "
    "||| || |||\\----+++++-++++--+-+--+++-+--+++--+-++-+-+-++------+++--++-----++-+-+++--+-++-+----+++/| |||  | ||||||||||     | |||| ||||| || |  | || ||   "
    "||| || |||     ||||| ||||  | |  ||| |  |||  | || | | ||      |||  ||     || | |||  | || |    ||| | |||  \\-++++++++++-----/ |||| ||||| || |  | || ||   "
    "|\\+-++-+++-----+++++-+++/  | |  ||| |  ||\\--+-++-+-+-++------+++--++-----++-+-+++--+-++-+----+++-+-+++----++++++++++-------++++-+++++-++-+--+-+/ ||   "
    "| | || |||     ||||| |||   | |  ||| |  ||   | || | | ||      |||  ||     || | |||/-+-++-+----+++-+-+++----++++++++++-------++++-+++++-++-+\\ | |  ||   "
    "| | || |||     ||||| ||| /-+-+--+++-+--++\\  | || | | || /----+++--++-----++-+-++++-+-++-+----+++-+-+++----++++++++++-------++++-+++++-++-++-+-+--++-\\ "
    "| | || |||     ||||| ||| | | |  ||| |  |||  | || | | || |    |||  ||     || | |||| | || |    \\++-+-+++----++++++++++-------++++-+++++-++-++-+-/  || | "
    "| | || ||\\-----+++/| ||| | | |  ||| |  |||  | || | | || |    |||  ||     || | |||| | || |     |\\-+-+++----++++++++++-------/||| ||||| || || |    || | "
    "| | || ||  /---+++-+-+++-+-+-+--+++-+--+++--+-++-+-+-++-+----+++--++-----++-+-++++-+-++-+-----+--+-+++----++++++++++--\\     ||| ||||| || || |    || | "
    "\\-+-++-++--+---/|| | ||| | | |  ||| |  |||  | || | | || |    |||  ||     || | |||| | || |     |  | \\++----++++++++++--+-----+++-/|||| || || |    || | "
    "  | || ||  |    || | ||| | | |  ||| |  |||  | || | | || |    |||  ||     || | |||| | || |     |  |  ||    ||||||||||  |     |||  |||| || || |    || | "
    "  | || ||  |    \\+-+-+++-+-+-+--+++-+--+++--+-/| | | || |    |||  ||     || | |||| | || |     |  |  ||/---++++++++++--+-----+++--++++-++-++-+\\   || | "
    "  | || || /+-----+-+-+++-+-+-+--+++-+--+++--+--+-+-+-++-+----+++-\\||     || | |||| | || |     |  |  |||   ||||||||||  |     |||  ||^| || || ||   || | "
    "  | || || ||     | | ||| | | |  ||| |  |||  |  | | | || |    ||| |||     || | |||| | || |     |  |  |||   ||||||||||  |     |||  |||| || || ||   || | "
    "  | || || ||     | | ||| | | |  ||| |  |||  |  | | | || |    ||| |||     || | ||||/+-++-+-----+--+-\\|||   ||||||||||  |     |||  |||| || || ||   || | "
    "/-+-++-++-++-----+-+-+++-+-+-+--+++-+--+++--+--+-+-+-++\\|    ||| |||     || | |||\\++-++-+-----+--+-++++---++++++++++--+-----+++--++++-++-+/ ||   || | "
    "| | ||/++-++-----+-+-+++-+-+-+--+++-+--+++--+--+-+-+-++++----+++-+++\\    || | ||| || || |     |  | ||||   ||||||||||  |     |||  |||| || |  ||   || | "
    "| | ||||| ||     | | ||| | |/+--+++-+--+++--+--+-+-+-++++----+++-++++----++-+-+++-++-++-+-----+--+-++++---++++++++++--+-----+++-\\|||| || |  ||   || | "
    "| | |||||/++-----+-+-+++\\| |||  ||| \\--+++--+--+-+-+-++++----+++-++++----++-+-+++-++-++-+-----+--+-++++---++++++++++--+-----+++-++/|| || |  ||   || | "
    "| | ||||||||     | | ||||| |||  |\\+----+++--+--+-+-+-++++----+++-++++----++-+-+++-++-++-+-----/  | ||||   ||||||||\\+--+-----+++-++-++-++-+--++---/| | "
    "| | ||||||||     | | ||||| |||  | |    |||  |  | | | ||||    ||| ||||    || | ||| || || |        | ||||   |||||||| |  |     ||| || || || |  ||    | | "
    "| | ||||||||     | | ||||| |||  | |    |||  |  | | | ||||    \\++-++++--->++-+-+++-++-++-+--------+-++++---++++++++-+--+-----+++-++-++-++-/  ||    | | "
    "| | ||||||||     | | ||||| |||  | |  /-+++--+--+-+-+-++++-----++-++++\\   || | ||| || || |        | ||||   |||||||| |  |     ||| || || ||    ||    | | "
    "| | ||||||||     | | ||||| |||  | |  | |||  |  | | | ||||     || |||||   || | ||| || || |        | ||||   |||||||| |  |     ||| || || ||    ||    | | "
    "| | ||||||||     | | ||||| |||  \\-+--+-+++--+--+-+-+-++++-----++-+++++>--++-/ ||| || || |        | ||||   |||||||| |  |     ||| || || ||    ||    | | "
    "| | ||||||||     | | ||||| |||   /+--+-+++--+--+\\| | ||||     || |||||   ||   ||| || || |        | |||\\---++++++++-+--+-----+++-++-++-++----+/    | | "
    "| \\-++++++++-----+-+-+++++-+++---++--+-/||  |  ||| | ||||     || |||||  /++---+++-++-++-+--------+\\|||    |||||||| |  |     ||| || || ||    |     | | "
    "|   ||||||||     | | ||||| |||   ||  |  ||  |  \\++-+-++++-----++-+++++--+++---+++-++-++-+--------+++/|    |||||||| |  |     ||| || || ||    |     | | "
    "|   ||||||\\+-----+-+-+++++-+++---++--+--++--+---++-+-++++-----++-/||||  |||   ||| || ||/+--------+++-+----++++++++-+--+-----+++-++-++-++----+\\    | | "
    "|   |||||| |     | \\-+++++-+++---++--+--++--+---++-+-++++-----++--++++--+++---+++-++-++++--------/|| |    ||||||\\+-+--+-----+++-++-/|/++----++\\   | | "
    "|   |||||| |     |   ||||| |||   ||  |  \\+--+---++-+-++++-----++--++++--+++---+++-++-++++---------++-+----++++/| | |  |     ||| ||  ||||    |||   | | "
    "|   |||||| |     |   ||||| |||   ||  |   |  |   || | ||||     ||  ||||  |\\+---+++-++-++++---------++-+----++++-+-+-+--+-----+++-++--++/|    |||   | | "
    "|   |||||| |    /+---+++++-+++---++--+---+--+---++-+-++++-----++--++++--+-+---+++-++-++++---------++-+----++++-+-+-+--+\\    ||| ||  || |    |||   | | "
    "|   |||||\\-+----++---+++/| |||   ||  |   |  |   || | ||||     ||  ||||  | |   ||| || ||||         || |    |||| | | |  ||    ||| ||  || |    |||   | | "
    "|   |||||  |  /-++---+++-+-+++---++--+---+--+---++-+-++++-----++--++++-\\| \\---+++-++-++++---------++-+----++++-+-+-+--++----+++-++--/| |    |||   | | "
    "|   |||||  |  | ||   ||| | ||\\---++--+---+--+---++-+-++++-----++--++++-++-----+++-++-+/||         || |  /-++++-+-+-+--++----+++-++---+-+----+++-\\ | | "
    "|   |||||  |  | ||   ||| | ||    \\+--+---+--+---/| | ||||     ||  |||| ||     ||| || | ||         || |  | |||| | | |  ||   /+++-++---+-+----+++-+-+\\| "
    "|   |||||  |  | ||   ||| | ||     |  |   |  |    | | ||||     ||  |||| ||     ||| \\+-+-++---------+/ |  | |||| | | |  ||   |||| ||   | |    ||| | ||| "
    "|   |||||  |  | ||   ||| | |\\-----+--+---+--+----+-+-++++-----++--++++-++-----+++--+-+-++---------+--+--+-++++-+-+-+--++---++++-/|   | |    ||| | ||| "
    "|   |||||  |  | ||   ||| | \\------+--+---+--+----+-+-++++-----++--++++-++-----+++--+-+-++---------+--+--+-++++-+-+-+--++---+++/  |   | |    ||| | ||| "
    "|   |||||  |  | ||   \\++-+--------+--+---+--+----+-+-++++-----++--++++-++-----+++--+-+-+/         |  |  | |||| |/+-+--++---+++---+--\\| |    ||| | ||| "
    "\\---+++++--+--+-++----++-+--------+--+---+--+----+-+-++/|     ||  |||| ||     |||  | | |          |  |  | |||| ||| |  ||   |||   |  || |    ||| | ||| "
    "    |||||  |  | ||    || \\--------+--+---/  |    | | || |     ||  |||| ||     |||  | | \\----------+--+--+-++++-+++-+--++---+++---+--++-+----+/| | ||| "
    "    |||||  |  | || /--++----------+--+--\\   |    | \\-++-+-----++--++++-++-----+++--+-+------------+--+--+-++++-+++-+--++---+++---+--++-/    | | | ||| "
    "    |||||  |  | || |  ||          |  |  |   \\----+---++-+-----++--++++-++-----+++--+-+------------+--/  | |||| ||| |  ||   |||   |  ||      | | | ||| "
    "    |||||  |  | || |  ||          |  |  |        |   |\\-+-----++--++++-++-----+++--+-+------------+-----+-++++-+++-+--++---++/   |  ||      | | | ||| "
    "    |||||  \\--+-++-+--++----------+--+--+--------+---+--+-----++--++++-++-----+++--+-+------------+-----+-++++-+++-+--/|   ||    |  ||      | | | ||| "
    "    |\\+++-----+-++-+--++----------+--+--+--------+---+--+-----++--++++-++-----+++--+-/            |     | |||| ||| |   |   ||    |  ||      | | | ||| "
    "    | |||  /--+-++-+--++----------+--+--+--------+---+--+-----++--++++-++-----+++\\ |              |     | |||| ||| |   |   ||    |  ||      | | | ||| "
    "    | |||  |  | || |  ||          |  |  |        |   |  \\-----++--++++-++-----++++-+--------------+-----+-++++-+++-+---+---++----+--++------+-+-+-++/ "
    "    | |||  |  | || |/-++----------+--+--+--------+---+----\\   ||  |||| ||     |||| |              |     | |||| ||| |   |   ||    v  ||      | | | ||  "
    "    | |||  |  | || || ||          |  |  |        \\---+----+---++--++++-++-----++++-/              |     | |||| ||| |   |   ||    |  ||      | | | ||  "
    " /--+-+++--+-\\| || || ||          |  |  |            |    |   ||  |||| ||     ||||                |     | |||| ||| |   |   ||    |  ||      | | | ||  "
    " |  | |||  | || || \\+-++----------+->+--/            |    |   ||  |\\++-++-----/|||                |     | |||| ||| |   |   ||    |  ||      | | | ||  "
    " |  | |||  | || ||  | ||          |  |               |    |   ||  | || ||      |||               /+-----+-++++-+++-+---+---++----+--++------+-+-+-++\\ "
    " |  | ||\\--+-++-++--+-++--->------+--+---------------+----+---++--+-++-++------+++---------------++-----+-/||| ||| |   |   ||    |  ||      | | | ||| "
    " |  | ||   | || ||  | ||          \\--+---------------+----+---+/  | || ||      |||               ||     |  ||| |\\+-+---+---++----+--/|      | | | ||| "
    " |  | ||   | || ||  | \\+-------------+---------------+----+---+---+-++-++------+++---------------++-----+--++/ | | |   |   ||    |   |      | | | ||| "
    " |  | ||   | |\\-++--+--+-------------+---------------+----+---+---+-++-/|      |\\+---------------++-----+--++--+-+-/   |   ||    |   \\------+-/ | ||| "
    " |  | ||   | |  ||  |  |             |               |    |   |   | ||  \\------+-+---------------+/     |  ||  | |     |   ||    |          |   | ||| "
    " |  \\-++---+-+--++--+--/             \\---------------+----+---+---+-+/         | |               |      \\--++--+-+-----+---++----+----------+---/ ||| "
    " |    |\\---+-+--++--+--------------------------------+----+---+---+-+----------+-+---------------+---------/|  | \\-----+---++----+----------+-----/|| "
    " \\----+----+-/  ||  |                                \\----+---/   | |          | |               |          |  |       |   ||    |          |      || "
    "      |    |    ||  |                                     |       \\-+----------+-+---------------+----------/  |       |   ||    |          |      || "
    "      |    |    \\+--+-------------------------------------+---------+----------+-+---------------+-------------+-------/   \\+----+----------+------/| "
    "      |    |     \\--+-------------------------------------+---------+----------+-+---------------+-------------+------------/    |          |       | "
    "      |    \\--------+-------------------------------------+---------+----------+-/               |             |                 |          |       | "
    "      |             \\-------------------------------------/         |          \\-----------------+-------------+-----------------/          |       | "
    "      |                                                             |                            |             \\----------------------------/       | "
    "      \\-------------------------------------------------------------/                            \\--------------------------------------------------/ "))
